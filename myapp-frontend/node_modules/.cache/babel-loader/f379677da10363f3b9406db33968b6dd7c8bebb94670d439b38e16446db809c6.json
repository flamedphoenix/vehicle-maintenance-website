{"ast":null,"code":"import React,{useState}from\"react\";import{useEffect}from\"react\";import{Navigate,useNavigate}from\"react-router-dom\";import axios from'axios';import{Box,Button,Container,TextField,Typography,Paper}from\"@mui/material\";import InputLabel from'@mui/material/InputLabel';import FormControl from'@mui/material/FormControl';import Select from'@mui/material/Select';import MenuItem from'@mui/material/MenuItem';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function AddLog(_ref){let{user}=_ref;if(!user){return/*#__PURE__*/_jsx(Navigate,{to:\"/\"});}const navigate=useNavigate();const[log,setLog]=useState({title:\"logs\",description:\"\",date:\"\",next_due:\"\",car_id:\"\"});const[cars,setCars]=useState([]);useEffect(()=>{const fetchCars=async()=>{try{const token=localStorage.getItem(\"token\");const response=await axios.get(\"http://203.29.242.50:8000/cars/\",{headers:{Authorization:`Bearer ${token}`}});setCars(response.data);}catch(error){console.error(\"Failed to fetch cars:\",error);}};fetchCars();},[]);const handleChange=e=>{const{name,value}=e.target;setLog(prev=>({...prev,[name]:name===\"car_id\"?Number(value):value}));};const handleSubmit=async e=>{e.preventDefault();console.log(\"Submitting log:\",log);try{const token=localStorage.getItem(\"token\");const payload={title:log.title,description:log.description,date:log.date,next_due:log.next_due,// Note snake_case here for backend\ncar_id:log.car_id};await axios.post(\"http://203.29.242.50:8000/logs/\",payload,{headers:{Authorization:`Bearer ${token}`}});navigate(\"/profile\");// Go back to profile after success\n}catch(error){console.error(\"Failed to add log:\",error);// optionally show error message to user\n}};return/*#__PURE__*/_jsx(Container,{maxWidth:\"sm\",children:/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{mt:6,p:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,children:\"Add Maintenance Log\"}),/*#__PURE__*/_jsxs(Box,{component:\"form\",onSubmit:handleSubmit,noValidate:true,children:[/*#__PURE__*/_jsx(TextField,{label:\"Title\",name:\"title\",value:log.title,onChange:handleChange,fullWidth:true,margin:\"normal\",required:true}),/*#__PURE__*/_jsx(TextField,{label:\"Description\",name:\"description\",value:log.description,onChange:handleChange,fullWidth:true,margin:\"normal\",multiline:true,rows:4,required:true}),/*#__PURE__*/_jsx(FormControl,{fullWidth:true,margin:\"normal\",required:true,children:/*#__PURE__*/_jsxs(Select,{labelId:\"car-label\",name:\"car_id\",value:log.car_id,label:\"Select Car\",onChange:handleChange,displayEmpty:true,children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:/*#__PURE__*/_jsx(\"em\",{children:\"Select a car\"})}),cars.map(car=>/*#__PURE__*/_jsx(MenuItem,{value:car.id,children:car.name},car.id))]})}),/*#__PURE__*/_jsx(TextField,{label:\"Date Performed\",name:\"date\",type:\"date\",value:log.date,onChange:handleChange,fullWidth:true,margin:\"normal\",InputLabelProps:{shrink:true},required:true}),/*#__PURE__*/_jsx(TextField,{label:\"Next Due\",name:\"next_due\",type:\"date\",value:log.next_due,onChange:handleChange,fullWidth:true,margin:\"normal\",InputLabelProps:{shrink:true}}),/*#__PURE__*/_jsxs(Box,{sx:{mt:3,display:\"flex\",justifyContent:\"space-between\"},children:[/*#__PURE__*/_jsx(Button,{variant:\"contained\",color:\"primary\",type:\"submit\",children:\"Save Log\"}),/*#__PURE__*/_jsx(Button,{variant:\"outlined\",color:\"secondary\",onClick:()=>navigate(\"/profile\"),children:\"Cancel\"})]})]})]})});}export default AddLog;","map":{"version":3,"names":["React","useState","useEffect","Navigate","useNavigate","axios","Box","Button","Container","TextField","Typography","Paper","InputLabel","FormControl","Select","MenuItem","jsx","_jsx","jsxs","_jsxs","AddLog","_ref","user","to","navigate","log","setLog","title","description","date","next_due","car_id","cars","setCars","fetchCars","token","localStorage","getItem","response","get","headers","Authorization","data","error","console","handleChange","e","name","value","target","prev","Number","handleSubmit","preventDefault","payload","post","maxWidth","children","elevation","sx","mt","p","variant","gutterBottom","component","onSubmit","noValidate","label","onChange","fullWidth","margin","required","multiline","rows","labelId","displayEmpty","map","car","id","type","InputLabelProps","shrink","display","justifyContent","color","onClick"],"sources":["/home/flamedphoenix/app/myapp-frontend/src/components/AddLog.jsx"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useEffect } from \"react\";\nimport { Navigate, useNavigate} from \"react-router-dom\";\nimport axios from 'axios';\nimport {\n  Box,\n  Button,\n  Container,\n  TextField,\n  Typography,\n  Paper,\n} from \"@mui/material\";\nimport InputLabel from '@mui/material/InputLabel';\nimport FormControl from '@mui/material/FormControl';\nimport Select from '@mui/material/Select';\nimport MenuItem from '@mui/material/MenuItem';\n\nfunction AddLog({ user }) {\n  if (!user) {\n    return <Navigate to=\"/\" />;\n  }\n\n  const navigate = useNavigate();\n\n  const [log, setLog] = useState({\n    title: \"logs\",\n    description: \"\",\n    date: \"\",\n    next_due: \"\",\n    car_id: \"\"\n  });\n\n\n  \n\n  const [cars, setCars] = useState([]);\n\n  useEffect(() => {\n    const fetchCars = async () => {\n      try {\n        const token = localStorage.getItem(\"token\");\n        const response = await axios.get(\"http://203.29.242.50:8000/cars/\", {\n          headers: {\n            Authorization: `Bearer ${token}`,\n          },\n        });\n        setCars(response.data);\n      } catch (error) {\n        console.error(\"Failed to fetch cars:\", error);\n      }\n    };\n\n  fetchCars();\n}, []);\n\n  const handleChange = (e) => {\n\n    const { name, value } = e.target;\n    setLog((prev) => ({ ...prev, [name]: name === \"car_id\" ? Number(value) : value, }));\n  };\n\n  const handleSubmit = async (e) => {\n  e.preventDefault();\n  console.log(\"Submitting log:\", log);\n\n  try {\n    const token = localStorage.getItem(\"token\");\n    const payload = {\n      title: log.title,\n      description: log.description,\n      date: log.date,\n      next_due: log.next_due,  // Note snake_case here for backend\n      car_id: log.car_id,\n    };\n    await axios.post(\"http://203.29.242.50:8000/logs/\", payload, {\n      headers: {\n        Authorization: `Bearer ${token}`,\n      },\n    });\n    navigate(\"/profile\");  // Go back to profile after success\n  } catch (error) {\n    console.error(\"Failed to add log:\", error);\n    // optionally show error message to user\n  }\n\n\n\n\n\n};\n  return (\n  <Container maxWidth=\"sm\">\n      <Paper elevation={3} sx={{ mt: 6, p: 4 }}>\n        <Typography variant=\"h5\" gutterBottom>\n          Add Maintenance Log\n        </Typography>\n        <Box component=\"form\" onSubmit={handleSubmit} noValidate>\n          <TextField\n            label=\"Title\"\n            name=\"title\"\n            value={log.title}\n            onChange={handleChange}\n            fullWidth\n            margin=\"normal\"\n            required\n          />\n          <TextField\n            label=\"Description\"\n            name=\"description\"\n            value={log.description}\n            onChange={handleChange}\n            fullWidth\n            margin=\"normal\"\n            multiline\n            rows={4}\n            required\n          />\n\n          <FormControl fullWidth margin=\"normal\" required>\n            <Select\n              labelId=\"car-label\"\n              name=\"car_id\"\n              value={log.car_id}\n              label=\"Select Car\"\n              onChange={handleChange}\n              displayEmpty\n            >\n              <MenuItem value=\"\">\n                <em>Select a car</em>\n              </MenuItem>\n              {cars.map((car) => (\n                <MenuItem key={car.id} value={car.id}>\n                  {car.name}\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n\n          <TextField\n            label=\"Date Performed\"\n            name=\"date\"\n            type=\"date\"\n            value={log.date}\n            onChange={handleChange}\n            fullWidth\n            margin=\"normal\"\n            InputLabelProps={{ shrink: true }}\n            required\n          />\n          <TextField\n            label=\"Next Due\"\n            name=\"next_due\"\n            type=\"date\"\n            value={log.next_due}\n            onChange={handleChange}\n            fullWidth\n            margin=\"normal\"\n            InputLabelProps={{ shrink: true }}\n          />\n          <Box sx={{ mt: 3, display: \"flex\", justifyContent: \"space-between\" }}>\n            <Button variant=\"contained\" color=\"primary\" type=\"submit\">\n              Save Log\n            </Button>\n            <Button variant=\"outlined\" color=\"secondary\" onClick={() => navigate(\"/profile\")}>\n              Cancel\n            </Button>\n          </Box>\n        </Box>\n      </Paper>\n    </Container>\n  );\n}\n\nexport default AddLog;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}