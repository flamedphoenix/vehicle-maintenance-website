{"ast":null,"code":"import axios from'axios';import{useEffect,useState}from'react';import{BrowserRouter,Routes,Route,Navigate}from'react-router-dom';import{Container,Box,Typography,Button}from'@mui/material';import Login from\"./components/Login\";import Signup from\"./components/Signup\";import UserProfile from\"./components/UserProfile\";import AddLog from\"./components/AddLog\";import{API_URL}from'./config';import AdminDashboard from\"./components/AdminDashboard\";import AdminRoute from\"./components/AdminRoute\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){const[user,setUser]=useState(null);const[showSignup,setShowSignup]=useState(false);// Fetch current user with JWT token if available\nconst fetchUser=async()=>{const token=localStorage.getItem(\"token\");if(!token){setUser(null);return;}try{const res=await axios.get(`${API_URL}/users/me`,{headers:{\"Authorization\":`Bearer ${token}`}});console.log(res.data);// check that is_admin is true for admin\nsetUser(res.data);// axios puts the response body in res.data\n}catch(error){console.error(\"Error fetching user:\",error);setUser(null);}};useEffect(()=>{fetchUser();},[]);// Called after successful login to reload user info\nconst handleLogin=()=>{fetchUser();};const handleLogout=()=>{localStorage.removeItem(\"token\");setUser(null);};return/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100%',minWidth:'100%',backgroundColor:'#f0f2f5',py:5,overflowX:\"hidden\",overflowY:\"hidden\"},children:/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:user?user.is_admin?/*#__PURE__*/_jsx(Navigate,{to:\"/admin\",replace:true}):/*#__PURE__*/_jsx(Navigate,{to:\"/profile\",replace:true}):showSignup?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Signup,{onSignup:()=>setShowSignup(false)}),/*#__PURE__*/_jsxs(Typography,{mt:2,sx:{textAlign:'center'},children:[\"Already have an account?\",\" \",/*#__PURE__*/_jsx(Button,{onClick:()=>setShowSignup(false),variant:\"text\",children:\"Login\"})]})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Login,{onLogin:handleLogin}),/*#__PURE__*/_jsxs(Typography,{mt:2,sx:{textAlign:'center'},children:[\"Don't have an account?\",\" \",/*#__PURE__*/_jsx(Button,{onClick:()=>setShowSignup(true),variant:\"text\",children:\"Sign Up\"})]})]})}),/*#__PURE__*/_jsx(Route,{path:\"/profile\",element:user?/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(UserProfile,{user:user,handleLogout:handleLogout})}):/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"/AddLog\",element:user?/*#__PURE__*/_jsx(AddLog,{user:user}):/*#__PURE__*/_jsx(Navigate,{to:\"/\",replace:true})}),/*#__PURE__*/_jsx(Route,{path:\"/admin\",element:/*#__PURE__*/_jsx(AdminRoute,{children:/*#__PURE__*/_jsx(AdminDashboard,{})})})]})});}export default App;","map":{"version":3,"names":["axios","useEffect","useState","BrowserRouter","Routes","Route","Navigate","Container","Box","Typography","Button","Login","Signup","UserProfile","AddLog","API_URL","AdminDashboard","AdminRoute","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","user","setUser","showSignup","setShowSignup","fetchUser","token","localStorage","getItem","res","get","headers","console","log","data","error","handleLogin","handleLogout","removeItem","sx","minHeight","minWidth","backgroundColor","py","overflowX","overflowY","children","path","element","is_admin","to","replace","onSignup","mt","textAlign","onClick","variant","onLogin"],"sources":["/home/flamedphoenix/app/myapp-frontend/src/App.js"],"sourcesContent":["import axios from 'axios';\nimport { useEffect, useState } from 'react';\nimport { BrowserRouter, Routes, Route, Navigate} from 'react-router-dom';\nimport { Container, Box, Typography, Button } from '@mui/material';\nimport Login from \"./components/Login\";\nimport Signup from \"./components/Signup\";\nimport UserProfile from \"./components/UserProfile\";\nimport AddLog from \"./components/AddLog\";\nimport { API_URL } from './config';\nimport AdminDashboard from \"./components/AdminDashboard\";\nimport AdminRoute from \"./components/AdminRoute\";\n\nfunction App() {\n  const [user, setUser] = useState(null);\n  const [showSignup, setShowSignup] = useState(false);\n\n  // Fetch current user with JWT token if available\n  const fetchUser = async () => {\n  const token = localStorage.getItem(\"token\");\n  if (!token) {\n    setUser(null);\n    return;\n  }\n\n  try {\n    const res = await axios.get(`${API_URL}/users/me`, {\n      headers: {\n        \"Authorization\": `Bearer ${token}`\n      }\n    });\n    console.log(res.data); // check that is_admin is true for admin\n    setUser(res.data);  // axios puts the response body in res.data\n    \n  } catch (error) {\n    console.error(\"Error fetching user:\", error);\n    setUser(null);\n  }\n};\n\n  useEffect(() => {\n    fetchUser();\n  }, []);\n\n  // Called after successful login to reload user info\n  const handleLogin = () => {\n    fetchUser();\n  };\n\n  const handleLogout = () => {\n    localStorage.removeItem(\"token\");\n    setUser(null);\n  };\n\n  return (\n\n\n    \n      <Box sx={{ \n                minHeight: '100%', \n                minWidth: '100%',\n                backgroundColor: '#f0f2f5', \n                py: 5,\n                overflowX: \"hidden\", \n                overflowY: \"hidden\", \n                }}>\n          <Routes>\n            <Route\n              path=\"/\"\n              element={\n                user ? (\n                  user.is_admin ? (\n                    <Navigate to=\"/admin\" replace />\n                  ) : (\n                    <Navigate to=\"/profile\" replace />\n                  )\n                ) : showSignup ? (\n                  <>\n                    <Signup onSignup={() => setShowSignup(false)} />\n                    <Typography mt={2} sx={{ textAlign: 'center' }}>\n                      Already have an account?{\" \"}\n                      <Button onClick={() => setShowSignup(false)} variant=\"text\">Login</Button>\n                    </Typography>\n                  </>\n                ) : (\n                  <>\n                    <Login onLogin={handleLogin} />\n                    <Typography mt={2} sx={{ textAlign: 'center' }}>\n                      Don't have an account?{\" \"}\n                      <Button onClick={() => setShowSignup(true)} variant=\"text\">Sign Up</Button>\n                    </Typography>\n                  </>\n                )\n              }\n            />\n\n            <Route\n              path=\"/profile\"\n              element={\n                user ? (\n                  <>\n                    <UserProfile user={user} handleLogout={handleLogout} />\n                  </>\n                ) : (\n                  <Navigate to=\"/\" replace />\n                )\n              }\n            />\n\n            <Route\n              path=\"/AddLog\"\n              element={\n                user ? <AddLog user={user} /> : <Navigate to=\"/\" replace />\n              }\n            />\n\n            <Route\n            path = \"/admin\"\n            element={\n              <AdminRoute>\n                <AdminDashboard />\n              </AdminRoute>\n            }\n            />\n\n          </Routes>\n        </Box>\n  );\n}\nexport default App;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}